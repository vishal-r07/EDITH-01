<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDITH v3.0 - Advanced AI Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800&family=Exo+2:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <!-- Add this CSS for webcam elements -->
    <style>
        #emotion-container {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid var(--primary);
            box-shadow: var(--glow);
            z-index: 20;
            opacity: 0.8; /* Changed from 0.3 to 0.8 */
            transition: all 0.5s ease;
        }

        #emotion-container.active {
            opacity: 0.8;
            transform: scale(1.05);
        }

        #emotion-video, #emotion-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .emotion-pulse {
            animation: emotionPulse 2s;
        }

        @keyframes emotionPulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 42, 109, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(255, 42, 109, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 42, 109, 0); }
        }
    </style>
    <style>
        :root {
            --primary: #00f3ff;
            --secondary: #9d4edd;
            --accent: #ff2a6d;
            --dark: #0a0a1a;
            --darker: #050511;
            --card-bg: rgba(10, 15, 35, 0.7);
            --glow: 0 0 10px rgba(0, 243, 255, 0.5);
            --accent-glow: 0 0 15px rgba(255, 42, 109, 0.5);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: radial-gradient(ellipse at center, var(--darker) 0%, var(--dark) 70%);
            color: #fff;
            font-family: 'Exo 2', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Grid lines background */
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                    linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
                    linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -3;
        }

        /* Holographic effect */
        .holographic-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                    radial-gradient(circle at 20% 30%, rgba(157, 78, 221, 0.1) 0%, transparent 40%),
                    radial-gradient(circle at 80% 70%, rgba(0, 243, 255, 0.1) 0%, transparent 40%);
            z-index: -2;
            animation: gridMove 30s infinite linear;
        }

        @keyframes gridMove {
            0% { transform: rotate(0.5deg) scale(1); }
            50% { transform: rotate(-0.5deg) scale(1.02); }
            100% { transform: rotate(0.5deg) scale(1); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 10;
        }

        /* Header with floating effect */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
            position: relative;
            animation: floatHeader 6s ease-in-out infinite;
        }

        @keyframes floatHeader {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--glow);
            animation: pulse 3s infinite;
        }

        .logo-icon i {
            font-size: 22px;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: var(--glow);
            letter-spacing: 2px;
            line-height: 1;
        }

        .logo p {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            letter-spacing: 1px;
            margin-top: 3px;
        }

        .user-info {
            text-align: right;
            position: relative;
        }

        .user-info h2 {
            font-size: 1.5rem;
            margin-bottom: 3px;
            color: var(--primary);
            text-shadow: var(--glow);
            font-weight: 600;
        }

        .user-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            font-style: italic;
        }

        /* Status bar */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 25px;
            box-shadow: var(--glow);
            border: 1px solid rgba(0, 243, 255, 0.3);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-light {
            width: 12px;
            height: 12px;
            background: #0f0;
            border-radius: 50%;
            box-shadow: 0 0 10px #0f0;
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            font-size: 1rem;
            color: var(--primary);
            font-weight: 500;
        }

        .status-text span {
            color: var(--accent);
            text-shadow: var(--accent-glow);
        }

        .controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            background: rgba(20, 30, 60, 0.8);
            color: var(--primary);
            border: 1px solid rgba(0, 243, 255, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Exo 2', sans-serif;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            backdrop-filter: blur(5px);
            position: relative;
            overflow: hidden;
        }

        .btn i {
            font-size: 1rem;
        }

        .btn:hover {
            background: rgba(0, 243, 255, 0.2);
            box-shadow: var(--glow);
        }

        /* Main content grid */
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        /* Floating panels */
        .panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--glow);
            border: 1px solid rgba(0, 243, 255, 0.3);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }

        .panel::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .panel-header::after {
            content: "";
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 80px;
            height: 2px;
            background: linear-gradient(90deg, var(--accent), transparent);
        }

        .panel-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .panel-title i {
            font-size: 1.2rem;
            color: var(--accent);
            text-shadow: var(--accent-glow);
        }

        /* Calendar */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            text-align: center;
            margin-bottom: 15px;
        }

        .calendar-header {
            color: var(--primary);
            font-weight: 600;
            padding: 8px 0;
            font-size: 0.9rem;
        }

        .calendar-day {
            background: rgba(30, 40, 70, 0.5);
            padding: 10px 0;
            border-radius: 6px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .calendar-day.today {
            background: rgba(0, 243, 255, 0.3);
            box-shadow: var(--glow);
            font-weight: 600;
            color: white;
        }

        .calendar-day.event::after {
            content: "";
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background: var(--accent);
            border-radius: 50%;
            box-shadow: var(--accent-glow);
        }

        .calendar-events {
            margin-top: 15px;
        }

        .event-item {
            background: linear-gradient(90deg, rgba(30, 40, 70, 0.5), rgba(20, 25, 50, 0.7));
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            border-left: 2px solid var(--accent);
            font-size: 0.95rem;
        }

        .event-time {
            font-weight: 600;
            color: var(--primary);
            min-width: 70px;
            font-size: 0.95rem;
        }

        .event-desc {
            flex-grow: 1;
            font-size: 0.95rem;
        }

        .event-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .event-edit-btn,
        .event-delete-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .event-edit-btn:hover {
            color: var(--primary);
            background: rgba(0, 243, 255, 0.1);
        }

        .event-delete-btn:hover {
            color: var(--accent);
            background: rgba(255, 42, 109, 0.1);
        }

        /* To-Do List */
        .todo-list {
            max-height: 250px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .todo-list::-webkit-scrollbar {
            width: 6px;
        }

        .todo-list::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 6px;
        }

        .todo-item {
            background: linear-gradient(90deg, rgba(30, 40, 70, 0.5), rgba(20, 25, 50, 0.7));
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            border-left: 2px solid var(--primary);
            font-size: 1rem;
        }

        .todo-check {
            width: 20px;
            height: 20px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
            transition: var(--transition);
            box-shadow: var(--glow);
        }

        .todo-check.checked {
            background: var(--primary);
        }

        .todo-check.checked::after {
            content: "✓";
            color: var(--dark);
            font-size: 14px;
            font-weight: bold;
        }

        .todo-text {
            flex-grow: 1;
            font-size: 1rem;
        }

        .todo-text.completed {
            text-decoration: line-through;
            color: rgba(255, 255, 255, 0.5);
        }

        .todo-delete {
            color: rgba(255, 100, 100, 0.7);
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
            font-size: 1rem;
        }

        .todo-input {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .todo-input input {
            flex-grow: 1;
            background: rgba(20, 30, 60, 0.7);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 6px;
            padding: 10px 15px;
            color: white;
            font-family: 'Exo 2', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
        }

        .todo-input input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: var(--glow);
        }

        .todo-input button {
            padding: 10px 15px;
        }

        /* Project cards */
        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .project-card {
            background: linear-gradient(135deg, rgba(30, 40, 70, 0.7), rgba(20, 25, 50, 0.8));
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .project-name {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--primary);
            font-weight: 600;
        }

        .project-desc {
            color: rgba(255, 255, 255, 0.85);
            margin-bottom: 15px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .project-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        /* Voice Assistant */
        .voice-assistant {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--glow);
            border: 1px solid rgba(0, 243, 255, 0.3);
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }

        .voice-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .voice-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--glow), var(--accent-glow);
            animation: pulse 3s infinite;
        }

        .voice-icon i {
            font-size: 22px;
        }

        .voice-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.6rem;
            color: var(--primary);
            text-shadow: var(--glow);
            font-weight: 600;
        }

        .voice-controls {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }

        .voice-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(20, 30, 60, 0.7);
            border: 2px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
            position: relative;
            overflow: hidden;
        }

        .voice-btn.active {
            background: rgba(0, 243, 255, 0.3);
            animation: pulse 2s infinite;
        }

        .voice-btn.speaking {
            background: rgba(255, 42, 109, 0.3);
            animation: pulse 1.5s infinite;
        }

        .voice-btn i {
            font-size: 28px;
            color: var(--primary);
        }

        .voice-btn.active i {
            color: var(--primary);
            text-shadow: var(--glow);
        }

        .voice-btn.speaking i {
            color: var(--accent);
            text-shadow: var(--accent-glow);
        }

        .voice-response {
            background: rgba(10, 20, 40, 0.6);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            min-height: 100px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .response-text {
            font-size: 1.1rem;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.95);
            position: relative;
            z-index: 2;
        }

        .typing-indicator {
            display: flex;
            gap: 6px;
            align-items: center;
            color: var(--primary);
            font-style: italic;
            font-size: 1rem;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            animation: bounce 1.5s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .command-list {
            margin-top: 20px;
            padding: 15px;
            background: rgba(10, 20, 40, 0.5);
            border-radius: 10px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            font-size: 0.9rem;
        }

        .command-list h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
            text-shadow: var(--glow);
            font-family: 'Orbitron', sans-serif;
        }

        .command-item {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .command-keyword {
            color: var(--accent);
            font-weight: 600;
            min-width: 120px;
        }

        /* Startup Animation */
        .startup-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 1.2s ease;
        }

        .startup-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
            text-align: center;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.7);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1.5s forwards;
            line-height: 1.2;
            letter-spacing: 2px;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .powered-by {
            margin-top: 25px;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.7);
            opacity: 0;
            animation: fadeIn 1.2s forwards 1.2s;
            letter-spacing: 1px;
        }

        .hidden {
            display: none;
        }

        /* Responsive Design */
        @media (min-width: 768px) {
            .main-content {
                grid-template-columns: 1fr 1fr;
            }

            .voice-assistant {
                grid-column: span 2;
            }

            .panel:last-child {
                grid-column: span 2;
            }
        }

        @media (min-width: 992px) {
            .container {
                padding: 20px;
            }

            .logo h1 {
                font-size: 2rem;
            }

            .panel {
                padding: 25px;
            }
        }

        .calendar-day.selected {
            background: rgba(255, 42, 109, 0.3);
            box-shadow: var(--accent-glow);
            font-weight: 700;
            color: white;
            transform: scale(1.05);
        }

        .calendar-day.event {
            position: relative;
        }

        /* New styles for v2.0 */
        .calendar-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 0 10px;
        }

        .calendar-nav-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 6px;
            transition: var(--transition);
        }

        .calendar-nav-btn:hover {
            background: rgba(0, 243, 255, 0.1);
        }

        .calendar-month {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            text-shadow: var(--glow);
        }

        .day-summary {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding: 10px;
            background: rgba(20, 30, 60, 0.5);
            border-radius: 8px;
            border: 1px solid rgba(0, 243, 255, 0.2);
        }

        .day-stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-shadow: var(--glow);
        }

        .stat-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .memory-panel {
            margin-top: 20px;
            background: rgba(10, 20, 40, 0.5);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(0, 243, 255, 0.2);
        }

        .memory-panel h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
            text-shadow: var(--glow);
            font-family: 'Orbitron', sans-serif;
        }

        .memory-item {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .memory-item:last-child {
            border-bottom: none;
        }

        .github-card {
            background: linear-gradient(135deg, rgba(30, 40, 70, 0.7), rgba(20, 25, 50, 0.8));
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .github-card a {
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .github-card a:hover {
            text-decoration: underline;
            color: var(--accent);
        }

        .github-desc {
            color: rgba(255, 255, 255, 0.85);
            margin: 10px 0;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .github-updated {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .search-result {
            background: rgba(10, 20, 40, 0.6);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid rgba(0, 243, 255, 0.2);
        }

        .mood-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5rem;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .event-modal {
            background: var(--darker);
            border-radius: 15px;
            padding: 25px;
            max-width: 500px;
            width: 90%;
            border: 1px solid var(--primary);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--primary);
            text-shadow: var(--glow);
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-form label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .modal-form input,
        .modal-form textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            background: rgba(20, 30, 60, 0.7);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 6px;
            color: white;
            font-family: 'Exo 2', sans-serif;
        }

        .modal-form textarea {
            min-height: 80px;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-btn {
            padding: 10px 20px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-family: 'Exo 2', sans-serif;
            font-weight: 600;
            transition: var(--transition);
        }

        .btn-primary {
            background: var(--primary);
            color: var(--dark);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .btn-primary:hover {
            background: rgba(0, 243, 255, 0.8);
            box-shadow: var(--glow);
        }

        .recurrence-options {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .recurrence-option {
            flex: 1;
            min-width: 80px;
            text-align: center;
            padding: 10px;
            background: rgba(20, 30, 60, 0.7);
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }

        .recurrence-option.selected {
            background: rgba(0, 243, 255, 0.3);
            box-shadow: var(--glow);
        }

        /* Glitch effect for startup */
        .glitch {
            position: relative;
        }

        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .glitch::before {
            left: 2px;
            text-shadow: -2px 0 #ff00c1;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }

        .glitch::after {
            left: -2px;
            text-shadow: -2px 0 #00fff9, 2px 2px #ff00c1;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }

        @keyframes glitch-anim {
            0% { clip: rect(42px, 9999px, 44px, 0); }
            5% { clip: rect(12px, 9999px, 59px, 0); }
            10% { clip: rect(48px, 9999px, 29px, 0); }
            15% { clip: rect(42px, 9999px, 73px, 0); }
            20% { clip: rect(63px, 9999px, 27px, 0); }
            25% { clip: rect(34px, 9999px, 55px, 0); }
            30% { clip: rect(86px, 9999px, 73px, 0); }
            35% { clip: rect(20px, 9999px, 20px, 0); }
            40% { clip: rect(26px, 9999px, 60px, 0); }
            45% { clip: rect(25px, 9999px, 66px, 0); }
            50% { clip: rect(57px, 9999px, 98px, 0); }
            55% { clip: rect(5px, 9999px, 46px, 0); }
            60% { clip: rect(82px, 9999px, 31px, 0); }
            65% { clip: rect(54px, 9999px, 27px, 0); }
            70% { clip: rect(28px, 9999px, 99px, 0); }
            75% { clip: rect(45px, 9999px, 69px, 0); }
            80% { clip: rect(23px, 9999px, 85px, 0); }
            85% { clip: rect(54px, 9999px, 84px, 0); }
            90% { clip: rect(45px, 9999px, 47px, 0); }
            95% { clip: rect(37px, 9999px, 20px, 0); }
            100% { clip: rect(73px, 9999px, 99px, 0); }
        }

        @keyframes glitch-anim2 {
            0% { clip: rect(65px, 9999px, 100px, 0); }
            5% { clip: rect(52px, 9999px, 74px, 0); }
            10% { clip: rect(79px, 9999px, 85px, 0); }
            15% { clip: rect(75px, 9999px, 5px, 0); }
            20% { clip: rect(67px, 9999px, 61px, 0); }
            25% { clip: rect(14px, 9999px, 79px, 0); }
            30% { clip: rect(1px, 9999px, 66px, 0); }
            35% { clip: rect(86px, 9999px, 30px, 0); }
            40% { clip: rect(23px, 9999px, 98px, 0); }
            45% { clip: rect(85px, 9999px, 72px, 0); }
            50% { clip: rect(71px, 9999px, 75px, 0); }
            55% { clip: rect(2px, 9999px, 48px, 0); }
            60% { clip: rect(30px, 9999px, 16px, 0); }
            65% { clip: rect(59px, 9999px, 50px, 0); }
            70% { clip: rect(41px, 9999px, 62px, 0); }
            75% { clip: rect(2px, 9999px, 82px, 0); }
            80% { clip: rect(47px, 9999px, 73px, 0); }
            85% { clip: rect(3px, 9999px, 27px, 0); }
            90% { clip: rect(26px, 9999px, 55px, 0); }
            95% { clip: rect(42px, 9999px, 97px, 0); }
            100% { clip: rect(38px, 9999px, 49px, 0); }
        }

        /* Hologram effect for processing */
        .hologram {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg,
            rgba(0, 243, 255, 0.1),
            rgba(157, 78, 221, 0.1),
            rgba(255, 42, 109, 0.1));
            z-index: 1;
            animation: hologram-pulse 3s infinite;
            opacity: 0.7;
        }

        @keyframes hologram-pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }
        
        /* ================ NEW FEATURES FOR V3 ================ */
        
        /* EDITH Orb */
        .edith-orb {
            position: fixed;
            top: 50%;
            right: 50px;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle at 30% 30%, var(--primary), var(--secondary));
            border-radius: 50%;
            box-shadow: 0 0 50px var(--primary);
            z-index: 5;
            animation: floatOrb 8s infinite ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: translateY(-50%);
            overflow: hidden;
        }
        
        @keyframes floatOrb {
            0%, 100% { transform: translateY(-50%) translateY(0) scale(1); }
            50% { transform: translateY(-50%) translateY(-20px) scale(1.05); }
        }
        
        .orb-inner {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            position: relative;
            overflow: hidden;
        }
        
        .orb-core {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: var(--accent);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px var(--accent);
            animation: pulseCore 2s infinite alternate;
        }
        
        @keyframes pulseCore {
            0% { transform: translate(-50%, -50%) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1.5); }
        }
        
        .orb-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .orb-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
            animation: orbParticleMove 3s infinite linear;
        }
        
        @keyframes orbParticleMove {
            0% { transform: translate(0, 0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)); opacity: 0; }
        }
        
        /* Audio-reactive pulse */
        .audio-pulse {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(0, 243, 255, 0.2);
            animation: pulse 2s infinite;
            opacity: 0;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0.7; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        /* Smart suggestions */
        .smart-suggestion {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card-bg);
            border: 1px solid var(--primary);
            border-radius: 10px;
            padding: 15px;
            max-width: 300px;
            box-shadow: var(--glow);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
            z-index: 100;
            backdrop-filter: blur(5px);
        }
        
        .smart-suggestion.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .suggestion-content {
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .suggestion-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .suggestion-btn {
            background: rgba(0, 243, 255, 0.2);
            border: none;
            color: var(--primary);
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        /* Sci-fi dashboard panels */
        .dashboard-panel {
            background: rgba(10, 20, 40, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .dashboard-panel h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
            text-shadow: var(--glow);
            font-family: 'Orbitron', sans-serif;
        }
        
        .dashboard-metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric-name {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .metric-value {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Loading state */
        .loading {
            position: relative;
            overflow: hidden;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.1), transparent);
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            100% { left: 100%; }
        }
        
        /* Chat mode */
        .chat-mode {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 243, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--primary);
            animation: pulse 2s infinite;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 42, 109, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: var(--accent-glow);
            transform: translateX(150%);
            transition: transform 0.5s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        /* Theme upgrade enhancements */
        .panel {
            transition: all 0.3s ease;
            transform: perspective(500px) rotateX(0);
        }
        
        .panel:hover {
            transform: perspective(500px) rotateX(3deg);
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.3);
        }
        
        .voice-btn:hover {
            transform: scale(1.1);
        }
        
        .waveform {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20px;
            display: flex;
            align-items: flex-end;
            gap: 2px;
            padding: 0 5px;
            overflow: hidden;
        }
        
        .wave-bar {
            flex: 1;
            background: var(--primary);
            border-radius: 2px 2px 0 0;
            animation: wave 1.5s infinite ease-in-out;
            animation-delay: calc(var(--delay) * 0.1s);
        }
        
        @keyframes wave {
            0%, 100% { height: 30%; }
            50% { height: 90%; }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .edith-orb {
                width: 80px;
                height: 80px;
                right: 20px;
            }
            
            .orb-inner {
                width: 50px;
                height: 50px;
            }
        }
    </style>
</head>
<body>
<!-- Background elements -->
<div class="holographic-grid"></div>
<div class="edith-orb" id="edith-orb">
    <div class="orb-inner">
        <div class="orb-core"></div>
        <div class="orb-particles" id="orb-particles"></div>
    </div>
</div>

<!-- Startup Animation -->
<div class="startup-animation" id="startup-animation">
    <div class="startup-text glitch" data-text="EDITH v3.0 ONLINE">
        <div>SYSTEM UPGRADED</div>
        <div>Hello Vishal.</div>
        <div>EDITH v3.0 ONLINE</div>
    </div>
    <div class="powered-by">Advanced AI Assistant</div>
</div>

<div class="container">
    <header>
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-robot"></i>
            </div>
            <div class="logo-text">
                <h1>EDITH v3.0</h1>
                <p>Advanced AI Assistant</p>
            </div>
        </div>
        <div class="user-info">
            <h2>Vishal</h2>
            <p>Welcome back, Sir</p>
            <div class="mood-indicator" id="mood-indicator">🤖</div>
        </div>
    </header>

    <div class="status-bar">
        <div class="status-indicator">
            <div class="status-light"></div>
            <div class="status-text">Status: <span>Operational</span></div>
        </div>
        <div class="controls">
            <button class="btn" id="music-btn">
                <i class="fas fa-music"></i> Music
            </button>
            <button class="btn" id="theme-btn">
                <i class="fas fa-moon"></i> Theme
            </button>
        </div>
    </div>

    <div class="voice-assistant">
        <div class="voice-header">
            <div class="voice-icon">
                <i class="fas fa-microphone-alt"></i>
            </div>
            <div class="voice-title">Voice Assistant</div>
            <div class="chat-mode" id="chat-mode">Continuous Chat Mode</div>
        </div>

        <div class="voice-controls">
            <div class="voice-btn" id="listen-btn">
                <i class="fas fa-microphone"></i>
            </div>
            <div class="voice-btn" id="speak-btn">
                <i class="fas fa-robot"></i>
            </div>
        </div>

        <div class="voice-response">
            <div class="waveform" id="waveform"></div>
            <div class="hologram hidden" id="hologram"></div>
            <div class="response-text" id="response-text">
                <div class="typing-indicator hidden" id="typing-indicator">
                    <span>Processing</span>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
                <div id="response-content">Ready for your command, Vishal.</div>
            </div>
        </div>

        <div class="command-list">
            <h3>Voice Commands:</h3>
            <div class="command-item">
                <span class="command-keyword">"search [query]"</span>
                <span>Search the web</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"play [song]"</span>
                <span>Search YouTube for music</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"generate random idea"</span>
                <span>Get tech project ideas</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"summarize my day"</span>
                <span>Today's tasks & events</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"recommend break activity"</span>
                <span>Get a break suggestion</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"analyze productivity"</span>
                <span>Get productivity stats</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"tell me a joke"</span>
                <span>Hear a random joke</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"change ui"</span>
                <span>Toggle light/dark mode</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"show memory"</span>
                <span>Recent commands</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"add event [details]"</span>
                <span>Create calendar event</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"show calendar"</span>
                <span>Display calendar</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"show events for [date]"</span>
                <span>View events for specific date</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"delete event [name]"</span>
                <span>Remove calendar event</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"add task [task]"</span>
                <span>Add to to-do list</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"complete task [task]"</span>
                <span>Mark task as done</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"delete task [task]"</span>
                <span>Remove from to-do list</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"show tasks"</span>
                <span>List all tasks</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"project status"</span>
                <span>Check progress</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"system report"</span>
                <span>Check system status</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"what time is it"</span>
                <span>Get current time</span>
            </div>
            <div class="command-item">
                <span class="command-keyword">"help"</span>
                <span>Show all commands</span>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="panel">
            <div class="panel-header">
                <div class="panel-title">
                    <i class="far fa-calendar-alt"></i> Calendar v3.0
                </div>
                <button class="btn" id="add-event-btn">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <div class="calendar-navigation">
                <button class="calendar-nav-btn" id="prev-month">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="calendar-month" id="current-month">January 2024</div>
                <button class="calendar-nav-btn" id="next-month">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <div class="calendar-grid" id="calendar-grid">
                <!-- Calendar will be generated by JS -->
            </div>

            <div class="calendar-events" id="calendar-events">
                <!-- Events will be loaded here -->
            </div>

            <div class="day-summary">
                <div class="day-stat">
                    <div class="stat-value" id="event-count">0</div>
                    <div class="stat-label">Events</div>
                </div>
                <div class="day-stat">
                    <div class="stat-value" id="task-count">0</div>
                    <div class="stat-label">Tasks</div>
                </div>
                <div class="day-stat">
                    <div class="stat-value" id="progress-value">0%</div>
                    <div class="stat-label">Progress</div>
                </div>
            </div>
            
            <div class="dashboard-panel">
                <h3>Productivity Metrics</h3>
                <div class="dashboard-metric">
                    <span class="metric-name">Focus Level</span>
                    <span class="metric-value">87%</span>
                </div>
                <div class="dashboard-metric">
                    <span class="metric-name">Task Completion</span>
                    <span class="metric-value">64%</span>
                </div>
                <div class="dashboard-metric">
                    <span class="metric-name">Meeting Efficiency</span>
                    <span class="metric-value">92%</span>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header">
                <div class="panel-title">
                    <i class="fas fa-tasks"></i> To-Do List
                </div>
                <button class="btn" id="add-task-btn">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <div class="todo-list" id="todo-list">
                <!-- To-do items will be added here -->
            </div>

            <div class="todo-input">
                <input type="text" id="new-task-input" placeholder="New task...">
                <button class="btn" id="add-task-button">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <div class="memory-panel">
                <h3>Recent Commands</h3>
                <div id="command-history">
                    <!-- Command history will appear here -->
                </div>
            </div>
            
            <div class="dashboard-panel">
                <h3>System Status</h3>
                <div class="dashboard-metric">
                    <span class="metric-name">CPU Usage</span>
                    <span class="metric-value">24%</span>
                </div>
                <div class="dashboard-metric">
                    <span class="metric-name">Memory</span>
                    <span class="metric-value">38%</span>
                </div>
                <div class="dashboard-metric">
                    <span class="metric-name">Network</span>
                    <span class="metric-value">Stable</span>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header">
                <div class="panel-title">
                    <i class="fab fa-github"></i> GitHub Projects
                </div>
                <button class="btn" id="refresh-github">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>

            <div class="project-grid" id="github-projects">
                <!-- GitHub projects will be loaded here -->
            </div>
            
            <div class="dashboard-panel">
                <h3>GitHub Insights</h3>
                <div class="dashboard-metric">
                    <span class="metric-name">Most Starred</span>
                    <span class="metric-value">EDITH-AI</span>
                </div>
                <div class="dashboard-metric">
                    <span class="metric-name">Last Push</span>
                    <span class="metric-value">2 hours ago</span>
                </div>
                <div class="dashboard-metric">
                    <span class="metric-name">Active Projects</span>
                    <span class="metric-value">7</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Event Modal -->
<div class="modal-overlay hidden" id="event-modal-overlay" style="display: none;">
    <div class="event-modal">
        <div class="modal-header">
            <div class="modal-title" id="modal-title">Add New Event</div>
            <button class="close-modal" id="close-modal">&times;</button>
        </div>
        <form class="modal-form" id="event-form">
            <input type="hidden" id="event-id">

            <label for="event-title">Event Title *</label>
            <input type="text" id="event-title" required>

            <label for="event-date">Date *</label>
            <input type="date" id="event-date" required>

            <label for="event-time">Time *</label>
            <input type="time" id="event-time" required>

            <label>Recurrence</label>
            <div class="recurrence-options">
                <div class="recurrence-option selected" data-value="none">None</div>
                <div class="recurrence-option" data-value="daily">Daily</div>
                <div class="recurrence-option" data-value="weekly">Weekly</div>
                <div class="recurrence-option" data-value="monthly">Monthly</div>
            </div>
            <input type="hidden" id="event-recurrence" value="none">

            <label for="event-description">Description</label>
            <textarea id="event-description"></textarea>
        </form>
        <div class="modal-actions">
            <button class="modal-btn btn-secondary" id="cancel-event">Cancel</button>
            <button class="modal-btn btn-primary" id="save-event">Save Event</button>
        </div>
    </div>
</div>

<!-- Smart Suggestion -->
<div class="smart-suggestion" id="smart-suggestion">
    <div class="suggestion-content">
        You've been working for 45 minutes. Would you like me to recommend a break activity?
    </div>
    <div class="suggestion-actions">
        <button class="suggestion-btn" id="suggestion-yes">Yes</button>
        <button class="suggestion-btn" id="suggestion-no">No</button>
    </div>
</div>

<!-- Notification -->
<div class="notification" id="notification">
    <i class="fas fa-bell"></i> Meeting in 15 minutes: Project Review
</div>

<!-- Audio elements -->
<audio id="background-music" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
</audio>
<audio id="voice-startup">
    <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
</audio>
<audio id="voice-command">
    <source src="https://www.soundjay.com/misc/sounds/notification-sound-1.wav" type="audio/wav">
</audio>
<script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
<script>
    // ================ STARTUP ================
    document.addEventListener('DOMContentLoaded', function() {
        const startupAnimation = document.getElementById('startup-animation');
        // Ensure event modal is hidden on load
        document.getElementById('event-modal-overlay').classList.add('hidden');

        // Play startup sound
        playStartupSound();

        // Speak welcome message
        setTimeout(() => {
            const welcomeMessage = "EDITH v3.0 online. All systems upgraded and ready for your command, Vishal.";
            speakText(welcomeMessage);
        }, 2000);

        setTimeout(() => {
            startupAnimation.style.opacity = '0';
            setTimeout(() => {
                startupAnimation.classList.add('hidden');
            }, 1200);
        }, 3500);

        // Initialize modules
        initCalendar();
        loadTodos();
        loadPreferences();
        initVoiceAssistant();
        loadGitHubProjects();
        loadCommandHistory();
        setupEventListeners();
        updateMoodIndicator();
        createOrbParticles();
        setupWaveform();

        // Set up mood tracking
        setInterval(updateMoodIndicator, 30000);
        
        // Set up smart suggestions
        setTimeout(showSmartSuggestion, 180000); // Show after 3 minutes
        setInterval(showSmartSuggestion, 600000); // Every 10 minutes
        
        // Show notification for demo
        setTimeout(() => {
            showNotification("Meeting in 15 minutes: Project Review");
        }, 5000);
    });

    // ================ PERSONALITY & MOOD ================
    const responses = {
        greetings: [
            "Hello Vishal! How can I assist you today? 😊",
            "Good to see you, Vishal! What's on your mind? 🤖",
            "Ready when you are, Vishal! 😎"
        ],
        affirmatives: [
            "Absolutely! Consider it done. 💪",
            "Right away, Vishal! ⚡",
            "On it! 🚀",
            "Mission accomplished! ✅"
        ],
        jokes: [
            "Why do programmers prefer dark mode? Because light attracts bugs! 😂",
            "What do you call a computer that sings? A Dell! 🎵",
            "Why did the web developer walk out of the restaurant? Because of the table layout! 😅"
        ],
        quotes: [
            "The best way to predict the future is to invent it. - Alan Kay 💡",
            "Innovation distinguishes between a leader and a follower. - Steve Jobs 🚀",
            "The only way to do great work is to love what you do. - Steve Jobs ❤️"
        ],
        breakActivities: [
            "Take a 5-minute walk and stretch your legs 🚶‍♂️",
            "Do some deep breathing exercises for 2 minutes 🧘‍♂️",
            "Get a glass of water and hydrate 💧",
            "Look at something 20 feet away for 20 seconds 👀",
            "Do 10 push-ups or squats to get your blood flowing 💪"
        ],
        techIdeas: [
            "Smart plant monitoring system with IoT sensors 🌱",
            "AI-powered personal finance advisor app 💰",
            "Augmented reality navigation for indoor spaces 🗺️",
            "Blockchain-based voting system for organizations 🗳️",
            "Gesture-controlled home automation system 🏠"
        ]
    };

    let mood = "neutral";
    let lastCommandTime = Date.now();

    function getRandomResponse(type) {
        const options = responses[type];
        return options[Math.floor(Math.random() * options.length)];
    }

    function updateMoodIndicator() {
        const moodIndicator = document.getElementById('mood-indicator');
        const idleTime = (Date.now() - lastCommandTime) / 60000; // in minutes

        if (idleTime > 15) {
            mood = "sleepy";
            moodIndicator.textContent = "😴";
        } else if (idleTime > 5) {
            mood = "neutral";
            moodIndicator.textContent = "🤖";
        } else {
            mood = "excited";
            moodIndicator.textContent = "🚀";
        }
    }

    // ================ COMMAND HISTORY ================
    function saveCommand(command) {
        let history = JSON.parse(localStorage.getItem('edith-command-history') || '[]');

        // Add new command to the beginning
        history.unshift({
            command: command,
            timestamp: new Date().toISOString()
        });

        // Keep only the last 5 commands
        if (history.length > 5) {
            history = history.slice(0, 5);
        }

        localStorage.setItem('edith-command-history', JSON.stringify(history));
        loadCommandHistory();
    }

    function loadCommandHistory() {
        const history = JSON.parse(localStorage.getItem('edith-command-history') || '[]');
        const historyContainer = document.getElementById('command-history');
        historyContainer.innerHTML = '';

        if (history.length === 0) {
            historyContainer.innerHTML = '<div class="memory-item">No recent commands</div>';
            return;
        }

        history.forEach(cmd => {
            const item = document.createElement('div');
            item.className = 'memory-item';

            const date = new Date(cmd.timestamp);
            const timeString = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            item.innerHTML = `
                    <span style="color: var(--accent);">${timeString}</span>
                    <span>${cmd.command}</span>
                `;

            historyContainer.appendChild(item);
        });
    }

    // ================ CALENDAR V2 ================
    let currentMonth = new Date().getMonth();
    let currentYear = new Date().getFullYear();
    let calendarEvents = [];

    function initCalendar() {
        loadCalendarEvents();
        renderCalendar();
        updateDaySummary();

        // Set up navigation
        document.getElementById('prev-month').addEventListener('click', () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        });

        document.getElementById('next-month').addEventListener('click', () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        });

        // Add event button
        document.getElementById('add-event-btn').addEventListener('click', () => {
            openEventModal();
        });
    }

    function loadCalendarEvents() {
        const saved = localStorage.getItem('edith-calendar-events');
        if (saved) {
            calendarEvents = JSON.parse(saved);
        } else {
            // Default events
            calendarEvents = [
                {
                    id: 1,
                    title: 'Project Review',
                    date: new Date().toISOString().split('T')[0],
                    time: '10:00',
                    recurrence: 'none'
                },
                {
                    id: 2,
                    title: 'Client Meeting',
                    date: new Date().toISOString().split('T')[0],
                    time: '14:30',
                    recurrence: 'none'
                },
                {
                    id: 3,
                    title: 'Weekly Sync',
                    date: new Date().toISOString().split('T')[0],
                    time: '16:00',
                    recurrence: 'weekly'
                }
            ];
            saveCalendarEvents();
        }
    }

    function saveCalendarEvents() {
        localStorage.setItem('edith-calendar-events', JSON.stringify(calendarEvents));
    }

    function renderCalendar() {
        const calendarGrid = document.getElementById('calendar-grid');
        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        const days = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];

        // Update month header
        document.getElementById('current-month').textContent = `${monthNames[currentMonth]} ${currentYear}`;

        // Clear existing calendar
        calendarGrid.innerHTML = '';

        // Add day headers
        days.forEach(day => {
            const header = document.createElement('div');
            header.classList.add('calendar-header');
            header.textContent = day;
            calendarGrid.appendChild(header);
        });

        // Get first day of month
        const firstDay = new Date(currentYear, currentMonth, 1);
        const lastDay = new Date(currentYear, currentMonth + 1, 0);

        // Add empty cells for days before the first day of the month
        for (let i = 0; i < firstDay.getDay(); i++) {
            const emptyCell = document.createElement('div');
            emptyCell.classList.add('calendar-day');
            calendarGrid.appendChild(emptyCell);
        }

        // Add days of the month
        for (let i = 1; i <= lastDay.getDate(); i++) {
            const dayCell = document.createElement('div');
            dayCell.classList.add('calendar-day');
            dayCell.textContent = i;

            const dateString = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;

            // Mark today
            const today = new Date();
            if (i === today.getDate() && currentMonth === today.getMonth() && currentYear === today.getFullYear()) {
                dayCell.classList.add('today');
            }

            // Check if day has events
            const dayEvents = getEventsForDate(dateString);
            if (dayEvents.length > 0) {
                dayCell.classList.add('event');

                // Add event count indicator
                const eventCount = document.createElement('div');
                eventCount.style.position = 'absolute';
                eventCount.style.top = '5px';
                eventCount.style.right = '5px';
                eventCount.style.background = 'var(--accent)';
                eventCount.style.color = 'white';
                eventCount.style.width = '18px';
                eventCount.style.height = '18px';
                eventCount.style.borderRadius = '50%';
                eventCount.style.fontSize = '0.7rem';
                eventCount.style.display = 'flex';
                eventCount.style.alignItems = 'center';
                eventCount.style.justifyContent = 'center';
                eventCount.textContent = dayEvents.length;
                dayCell.appendChild(eventCount);
            }

            // Add click event to view events for this date
            dayCell.addEventListener('click', () => {
                viewEventsForDate(dateString);
            });

            calendarGrid.appendChild(dayCell);
        }

        // Show today's events by default
        const today = new Date();
        const todayString = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
        viewEventsForDate(todayString);
    }

    function getEventsForDate(dateString) {
        const date = new Date(dateString);
        const dayOfWeek = date.getDay();
        const dayOfMonth = date.getDate();

        return calendarEvents.filter(event => {
            const eventDate = new Date(event.date);

            // Check if this is the exact date
            if (event.date === dateString) return true;

            // Check recurring events
            if (event.recurrence === 'daily') {
                return eventDate <= date;
            }
            if (event.recurrence === 'weekly') {
                return eventDate.getDay() === dayOfWeek && eventDate <= date;
            }
            if (event.recurrence === 'monthly') {
                return eventDate.getDate() === dayOfMonth && eventDate <= date;
            }

            return false;
        });
    }

    function viewEventsForDate(dateString) {
        const events = getEventsForDate(dateString);
        const eventsContainer = document.getElementById('calendar-events');
        eventsContainer.innerHTML = '';

        // Highlight selected date in calendar
        const allDays = document.querySelectorAll('.calendar-day');
        allDays.forEach(day => day.classList.remove('selected'));

        const selectedDay = Array.from(allDays).find(day => {
            return day.textContent == new Date(dateString).getDate();
        });

        if (selectedDay) {
            selectedDay.classList.add('selected');
        }

        // Add date header
        const date = new Date(dateString);
        const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const isToday = date.toDateString() === new Date().toDateString();

        const dateHeader = document.createElement('h3');
        dateHeader.style.margin = '15px 0 10px';
        dateHeader.style.color = 'var(--primary)';
        dateHeader.textContent = isToday ? "Today's Events" : date.toLocaleDateString('en-US', dateOptions);
        eventsContainer.appendChild(dateHeader);

        if (events.length === 0) {
            const noEvents = document.createElement('div');
            noEvents.style.textAlign = 'center';
            noEvents.style.color = 'rgba(255, 255, 255, 0.6)';
            noEvents.style.padding = '20px';
            noEvents.textContent = isToday ? 'No events scheduled for today' : 'No events scheduled for this date';
            eventsContainer.appendChild(noEvents);
        } else {
            events.forEach(event => {
                const eventItem = document.createElement('div');
                eventItem.classList.add('event-item');
                eventItem.setAttribute('data-event-id', event.id);

                const time = event.time;
                const [hours, minutes] = time.split(':');
                const formattedTime = `${hours > 12 ? hours - 12 : hours}:${minutes} ${hours >= 12 ? 'PM' : 'AM'}`;

                eventItem.innerHTML = `
                        <div class="event-time">${formattedTime}</div>
                        <div class="event-desc">
                            <div><strong>${event.title}</strong></div>
                            <div style="font-size: 0.85rem; color: rgba(255, 255, 255, 0.7);">${event.description || ''}</div>
                        </div>
                        <div class="event-actions">
                            <button class="event-edit-btn" data-id="${event.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="event-delete-btn" data-id="${event.id}">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;

                eventsContainer.appendChild(eventItem);
            });

            // Add event listeners for edit/delete
            document.querySelectorAll('.event-edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const eventId = e.target.closest('button').getAttribute('data-id');
                    openEventModal(eventId);
                });
            });

            document.querySelectorAll('.event-delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const eventId = e.target.closest('button').getAttribute('data-id');
                    deleteEvent(eventId);
                });
            });
        }

        updateDaySummary();
    }

    function updateDaySummary() {
        // For demo purposes, we'll generate some random stats
        const eventCount = Math.floor(Math.random() * 5);
        const taskCount = Math.floor(Math.random() * 8);
        const progressValue = Math.floor(Math.random() * 100);

        document.getElementById('event-count').textContent = eventCount;
        document.getElementById('task-count').textContent = taskCount;
        document.getElementById('progress-value').textContent = `${progressValue}%`;
    }

    // ================ EVENT MODAL ================
    function openEventModal(eventId = null) {
        const modal = document.getElementById('event-modal-overlay');
        const form = document.getElementById('event-form');
        const title = document.getElementById('modal-title');

        if (eventId) {
            // Edit existing event
            const event = calendarEvents.find(e => e.id == eventId);
            if (event) {
                title.textContent = "Edit Event";
                document.getElementById('event-id').value = event.id;
                document.getElementById('event-title').value = event.title;
                document.getElementById('event-date').value = event.date;
                document.getElementById('event-time').value = event.time;
                document.getElementById('event-recurrence').value = event.recurrence || 'none';
                document.getElementById('event-description').value = event.description || '';

                // Set recurrence selection
                document.querySelectorAll('.recurrence-option').forEach(option => {
                    option.classList.remove('selected');
                    if (option.getAttribute('data-value') === event.recurrence) {
                        option.classList.add('selected');
                    }
                });
            }
        } else {
            // Create new event
            title.textContent = "Add New Event";
            form.reset();
            document.getElementById('event-date').value = new Date().toISOString().split('T')[0];
            document.getElementById('event-time').value = '09:00';
            document.getElementById('event-recurrence').value = 'none';

            // Reset recurrence selection
            document.querySelectorAll('.recurrence-option').forEach(option => {
                option.classList.remove('selected');
                if (option.getAttribute('data-value') === 'none') {
                    option.classList.add('selected');
                }
            });
        }

        modal.classList.remove('hidden');
    }

    function closeEventModal() {
        document.getElementById('event-modal-overlay').classList.add('hidden');
    }

    function saveEvent() {
        const form = document.getElementById('event-form');
        const eventId = document.getElementById('event-id').value;
        const title = document.getElementById('event-title').value;
        const date = document.getElementById('event-date').value;
        const time = document.getElementById('event-time').value;
        const recurrence = document.getElementById('event-recurrence').value;
        const description = document.getElementById('event-description').value;

        if (!title || !date || !time) {
            alert('Please fill in all required fields');
            return;
        }

        if (eventId) {
            // Update existing event
            const index = calendarEvents.findIndex(e => e.id == eventId);
            if (index !== -1) {
                calendarEvents[index] = {
                    ...calendarEvents[index],
                    title,
                    date,
                    time,
                    recurrence,
                    description
                };
            }
        } else {
            // Add new event
            const newEvent = {
                id: Date.now(),
                title,
                date,
                time,
                recurrence,
                description
            };
            calendarEvents.push(newEvent);
        }

        saveCalendarEvents();
        renderCalendar();
        closeEventModal();

        // Show confirmation
        const response = eventId ?
            `Event "${title}" updated successfully!` :
            `Event "${title}" added to your calendar!`;
        speakText(response);
        document.getElementById('response-content').textContent = response;
    }

    function deleteEvent(eventId) {
        const event = calendarEvents.find(e => e.id == eventId);
        if (!event) return;

        if (confirm(`Are you sure you want to delete the event "${event.title}"?`)) {
            calendarEvents = calendarEvents.filter(e => e.id != eventId);
            saveCalendarEvents();
            renderCalendar();

            const response = `Event "${event.title}" deleted.`;
            speakText(response);
            document.getElementById('response-content').textContent = response;
        }
    }

    // ================ GITHUB INTEGRATION ================
    async function loadGitHubProjects() {
        const container = document.getElementById('github-projects');
        container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--primary);">Loading GitHub projects...</div>';

        try {
            const response = await fetch('https://api.github.com/users/vishal-r07/repos');
            const repos = await response.json();

            if (!repos || repos.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--accent);">No public repositories found</div>';
                return;
            }

            container.innerHTML = '';

            repos.forEach(repo => {
                const card = document.createElement('div');
                card.className = 'github-card';

                const updatedAt = new Date(repo.updated_at);
                const now = new Date();
                const diffDays = Math.floor((now - updatedAt) / (1000 * 60 * 60 * 24));

                card.innerHTML = `
                        <div class="project-name">
                            <a href="${repo.html_url}" target="_blank">${repo.name}</a>
                        </div>
                        <div class="github-desc">${repo.description || 'No description available'}</div>
                        <div class="github-updated">
                            <i class="far fa-clock"></i>
                            Updated ${diffDays === 0 ? 'today' : `${diffDays} days ago`}
                        </div>
                    `;

                container.appendChild(card);
            });
        } catch (error) {
            console.error('Error loading GitHub projects:', error);
            container.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--accent);">Failed to load projects</div>';
        }
    }

    // ================ VOICE COMMANDS ================
    function initVoiceAssistant() {
        const listenBtn = document.getElementById('listen-btn');
        const speakBtn = document.getElementById('speak-btn');
        const responseContent = document.getElementById('response-content');
        const typingIndicator = document.getElementById('typing-indicator');
        const hologram = document.getElementById('hologram');
        const chatMode = document.getElementById('chat-mode');
        
        let isChatMode = false;
        let isListening = false;

        // Speech recognition setup
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.lang = 'en-US';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;
        }

        listenBtn.addEventListener('click', () => {
            if (isListening) {
                if (recognition) recognition.stop();
                listenBtn.classList.remove('active');
                isListening = false;
                const response = "Voice recognition stopped.";
                responseContent.textContent = response;
                speakText(response);
            } else {
                if (recognition) {
                    recognition.start();
                    listenBtn.classList.add('active');
                    isListening = true;
                    playCommandSound();
                    const response = "Listening... Speak now.";
                    responseContent.textContent = response;
                    speakText(response);
                } else {
                    const response = "Speech recognition not supported in this browser.";
                    responseContent.textContent = response;
                    speakText(response);
                }
            }
        });

        if (recognition) {
            recognition.onresult = (event) => {
                const speechResult = event.results[0][0].transcript.toLowerCase();
                listenBtn.classList.remove('active');
                isListening = false;
                showTypingIndicator();

                // Save command to history
                saveCommand(speechResult);
                lastCommandTime = Date.now();
                updateMoodIndicator();

                setTimeout(() => {
                    processVoiceCommand(speechResult);
                    
                    // Continue listening if in chat mode
                    if (isChatMode) {
                        setTimeout(() => {
                            recognition.start();
                            listenBtn.classList.add('active');
                            isListening = true;
                            responseContent.textContent = "Listening...";
                        }, 1000);
                    }
                }, 2000);
            };

            recognition.onerror = (event) => {
                listenBtn.classList.remove('active');
                isListening = false;
                const response = "Error occurred in recognition: " + event.error;
                responseContent.textContent = response;
                speakText(response);
            };
        }

        speakBtn.addEventListener('click', () => {
            const synth = window.speechSynthesis;
            if (synth.speaking) {
                synth.cancel();
                speakBtn.classList.remove('speaking');
                const response = "Speech stopped.";
                responseContent.textContent = response;
                speakText(response);
            } else {
                speakBtn.classList.add('speaking');
                showTypingIndicator();

                setTimeout(() => {
                    const message = "All systems are operational. Your projects are progressing as scheduled. How can I assist you further, Vishal?";
                    speakText(message);
                    responseContent.innerHTML = message;
                }, 2000);
            }
        });
        
        // Toggle chat mode
        chatMode.addEventListener('click', () => {
            isChatMode = !isChatMode;
            if (isChatMode) {
                chatMode.style.background = "rgba(255, 42, 109, 0.3)";
                const response = "Continuous chat mode activated. I'll keep listening for your commands.";
                speakText(response);
                responseContent.textContent = response;
                
                // Start listening
                if (recognition && !isListening) {
                    recognition.start();
                    listenBtn.classList.add('active');
                    isListening = true;
                }
            } else {
                chatMode.style.background = "rgba(0, 243, 255, 0.2)";
                const response = "Continuous chat mode deactivated.";
                speakText(response);
                responseContent.textContent = response;
            }
        });

        function processVoiceCommand(command) {
            let response = getRandomResponse('affirmatives');

            // Search command
            if (command.startsWith('search ')) {
                const query = command.substring(7).trim();
                if (query) {
                    showTypingIndicator();
                    searchWeb(query);
                    return;
                } else {
                    response = "Please specify what you want to search for.";
                }
            }
            // Play song command
            else if (command.startsWith('play ')) {
                const song = command.substring(5).trim();
                if (song) {
                    window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(song)}`, '_blank');
                    response = `Opening YouTube for ${song}`;
                } else {
                    response = "Please specify which song to play.";
                }
            }
            // Random idea command
            else if (command.includes('generate random idea') || command.includes('random idea')) {
                const idea = getRandomResponse('techIdeas');
                response = `How about: "${idea}"?`;
            }
            // Summarize day command
            else if (command.includes('summarize my day') || command.includes('day summary')) {
                const now = new Date();
                const hour = now.getHours();
                let greeting = "Good ";
                if (hour < 12) greeting += "morning";
                else if (hour < 18) greeting += "afternoon";
                else greeting += "evening";
                
                response = `${greeting} Vishal. You have 3 meetings, 5 tasks to complete, and 2 project milestones today. You've completed 60% of your daily goals. Keep up the good work! 💪`;
            }
            // Break activity command
            else if (command.includes('recommend break activity') || command.includes('break suggestion')) {
                const activity = getRandomResponse('breakActivities');
                response = `I recommend: "${activity}"`;
            }
            // Productivity analysis command
            else if (command.includes('analyze productivity') || command.includes('productivity report')) {
                response = "Based on your activity, you've completed 8 tasks today with 90% efficiency. Your focus time was 4.2 hours. Excellent productivity today! 🚀";
            }
            // Change theme command
            else if (command.includes('change ui') || command.includes('toggle theme')) {
                toggleTheme();
                response = "Theme changed successfully.";
            }
            // Tell a joke command
            else if (command.includes('tell me a joke') || command.includes('joke')) {
                response = getRandomResponse('jokes');
            }
            // Show memory command
            else if (command.includes('show memory') || command.includes('recent commands')) {
                loadCommandHistory();
                response = "Showing your recent commands in the memory panel.";
            }
            // Add event command
            else if (command.startsWith('add event ')) {
                const eventDetails = command.substring(10).trim();
                if (eventDetails) {
                    // Parse event details (simplified)
                    const title = eventDetails.split(' on ')[0];
                    const date = new Date();
                    date.setDate(date.getDate() + 2); // Default to 2 days from now

                    const newEvent = {
                        id: Date.now(),
                        title: title,
                        date: date.toISOString().split('T')[0],
                        time: '10:00',
                        recurrence: 'none'
                    };

                    calendarEvents.push(newEvent);
                    saveCalendarEvents();
                    renderCalendar();

                    response = `Event "${title}" added to your calendar for ${date.toLocaleDateString()}.`;
                } else {
                    response = "Please specify event details. For example: 'Add event Team meeting on Friday'";
                }
            }
            // Show events command
            else if (command.startsWith('show events for ')) {
                const dateStr = command.substring(16).trim();
                if (dateStr) {
                    // This is a simplified implementation
                    response = `Showing events for ${dateStr}`;
                } else {
                    response = "Please specify a date. For example: 'Show events for tomorrow'";
                }
            }
            // Delete event command
            else if (command.startsWith('delete event ')) {
                const eventName = command.substring(13).trim();
                if (eventName) {
                    // This is a simplified implementation
                    response = `Event "${eventName}" deleted.`;
                } else {
                    response = "Please specify which event to delete.";
                }
            }
            // Add task command
            else if (command.startsWith('add task ')) {
                const task = command.substring(9).trim();
                if (task) {
                    addTodoToDOM(task);
                    saveTodos();
                    response = `Task "${task}" added to your to-do list.`;
                } else {
                    response = "Please specify a task to add.";
                }
            }
            // Complete task command
            else if (command.startsWith('complete task ')) {
                const task = command.substring(14).trim();
                if (task) {
                    // This is a simplified implementation
                    response = `Task "${task}" marked as completed.`;
                } else {
                    response = "Please specify which task to complete.";
                }
            }
            // Delete task command
            else if (command.startsWith('delete task ')) {
                const task = command.substring(12).trim();
                if (task) {
                    // This is a simplified implementation
                    response = `Task "${task}" deleted.`;
                } else {
                    response = "Please specify which task to delete.";
                }
            }
            // Show tasks command
            else if (command.includes('show tasks')) {
                response = "Showing your current tasks.";
            }
            // Project status command
            else if (command.includes('project status')) {
                response = "ESP32 Development: 65% complete. Radar System: 40% complete.";
            }
            // System report command
            else if (command.includes('system report')) {
                response = "All systems operational. CPU: 12% load. Memory: 42% utilized. Network: stable.";
            }
            // Time command
            else if (command.includes('what time is it')) {
                const now = new Date();
                const timeString = now.toLocaleTimeString();
                response = `The current time is ${timeString}.`;
            }
            // Help command
            else if (command.includes('help')) {
                response = "I can help you with tasks, calendar, projects, system status, time, and more. Try saying 'add task', 'show calendar', or 'project status'.";
            }
            // Default response
            else {
                response = getRandomResponse('greetings');
            }

            responseContent.innerHTML = response;
            speakText(response);
        }

        function showTypingIndicator() {
            responseContent.innerHTML = '';
            typingIndicator.classList.remove('hidden');
            hologram.classList.remove('hidden');

            setTimeout(() => {
                typingIndicator.classList.add('hidden');
                hologram.classList.add('hidden');
            }, 2000);
        }
    }

    // ================ WEB SEARCH ================
    async function searchWeb(query) {
        const responseContent = document.getElementById('response-content');
        const hologram = document.getElementById('hologram');

        try {
            const response = await fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json&no_redirect=1&skip_disambig=1`);
            const data = await response.json();

            let result = "";

            if (data.AbstractText) {
                result = data.AbstractText;
            } else if (data.RelatedTopics && data.RelatedTopics.length > 0) {
                result = data.RelatedTopics[0].Text;
            } else {
                result = `I couldn't find a direct answer for "${query}". Try rephrasing your question.`;
            }

            responseContent.innerHTML = `<div class="search-result"><strong>Search results for "${query}":</strong><br>${result}</div>`;
            hologram.classList.add('hidden');
            speakText(result);
        } catch (error) {
            console.error('Search error:', error);
            responseContent.innerHTML = `Sorry, I encountered an error while searching for "${query}".`;
            hologram.classList.add('hidden');
            speakText(responseContent.textContent);
        }
    }

    // ================ THEME TOGGLE ================
    function toggleTheme() {
        const body = document.body;
        const themeBtn = document.getElementById('theme-btn');

        if (body.classList.contains('light-mode')) {
            body.classList.remove('light-mode');
            themeBtn.innerHTML = '<i class="fas fa-moon"></i> Theme';
            localStorage.setItem('edith-theme', 'dark');
        } else {
            body.classList.add('light-mode');
            themeBtn.innerHTML = '<i class="fas fa-sun"></i> Theme';
            localStorage.setItem('edith-theme', 'light');
        }
    }

    // ================ SETUP EVENT LISTENERS ================
    function setupEventListeners() {
        // Add task button
        document.getElementById('add-task-button').addEventListener('click', addNewTask);
        document.getElementById('new-task-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addNewTask();
        });

        // Theme toggle
        document.getElementById('theme-btn').addEventListener('click', toggleTheme);

        // Music toggle
        document.getElementById('music-btn').addEventListener('click', toggleMusic);

        // GitHub refresh
        document.getElementById('refresh-github').addEventListener('click', loadGitHubProjects);

        // Event modal setup
        document.getElementById('close-modal').addEventListener('click', closeEventModal);
        document.getElementById('cancel-event').addEventListener('click', closeEventModal);
        document.getElementById('save-event').addEventListener('click', saveEvent);

        // Recurrence options
        document.querySelectorAll('.recurrence-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.recurrence-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                document.getElementById('event-recurrence').value = option.getAttribute('data-value');
            });
        });

        // Close modal when clicking outside
        document.getElementById('event-modal-overlay').addEventListener('click', (e) => {
            if (e.target === document.getElementById('event-modal-overlay')) {
                closeEventModal();
            }
        });
        
        // Smart suggestions
        document.getElementById('suggestion-yes').addEventListener('click', () => {
            const activity = getRandomResponse('breakActivities');
            speakText(`I recommend: ${activity}`);
            document.getElementById('smart-suggestion').classList.remove('show');
        });
        
        document.getElementById('suggestion-no').addEventListener('click', () => {
            document.getElementById('smart-suggestion').classList.remove('show');
        });
    }

    // ================ TASK MANAGEMENT ================
    function loadTodos() {
        const todoList = document.getElementById('todo-list');
        const savedTodos = localStorage.getItem('edith-todos');

        let todos;
        if (savedTodos) {
            todos = JSON.parse(savedTodos);
        } else {
            todos = [
                { text: 'Review ESP32 design', completed: true },
                { text: 'Prepare for client meeting', completed: false },
                { text: 'Update documentation', completed: false },
                { text: 'Research new IoT sensors', completed: false },
                { text: 'Test radar system prototype', completed: true }
            ];
            localStorage.setItem('edith-todos', JSON.stringify(todos));
        }

        todoList.innerHTML = '';

        todos.forEach((todo) => {
            addTodoToDOM(todo.text, todo.completed);
        });
    }

    function saveTodos() {
        const todos = [];
        document.querySelectorAll('.todo-item').forEach(item => {
            const text = item.querySelector('.todo-text').textContent;
            const completed = item.querySelector('.todo-check').classList.contains('checked');
            todos.push({ text, completed });
        });

        localStorage.setItem('edith-todos', JSON.stringify(todos));
    }

    function addTodoToDOM(text, completed = false) {
        const todoList = document.getElementById('todo-list');
        const todoItem = document.createElement('div');
        todoItem.classList.add('todo-item');

        todoItem.innerHTML = `
                <div class="todo-check ${completed ? 'checked' : ''}"></div>
                <div class="todo-text ${completed ? 'completed' : ''}">${text}</div>
                <div class="todo-delete"><i class="fas fa-trash-alt"></i></div>
            `;

        // Add event listeners
        const checkBtn = todoItem.querySelector('.todo-check');
        const deleteBtn = todoItem.querySelector('.todo-delete');
        const todoText = todoItem.querySelector('.todo-text');

        checkBtn.addEventListener('click', () => {
            checkBtn.classList.toggle('checked');
            todoText.classList.toggle('completed');
            saveTodos();
        });

        deleteBtn.addEventListener('click', () => {
            todoItem.style.transform = 'translateX(100px)';
            todoItem.style.opacity = '0';
            setTimeout(() => {
                todoItem.remove();
                saveTodos();
            }, 300);
        });

        todoList.appendChild(todoItem);
    }

    function addNewTask() {
        const input = document.getElementById('new-task-input');
        const text = input.value.trim();

        if (text) {
            addTodoToDOM(text);
            input.value = '';
            saveTodos();

            // Animate the new task
            const todos = document.querySelectorAll('.todo-item');
            const lastTodo = todos[todos.length - 1];
            lastTodo.style.animation = 'none';
            setTimeout(() => {
                lastTodo.style.animation = 'fadeIn 0.6s ease';
            }, 10);
        }
    }

    // ================ MUSIC MANAGEMENT ================
    let musicPlaying = false;
    const backgroundMusic = document.getElementById('background-music');

    function loadPreferences() {
        // Load theme
        const savedTheme = localStorage.getItem('edith-theme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-mode');
            document.getElementById('theme-btn').innerHTML = '<i class="fas fa-sun"></i> Theme';
        }

        // Load music state
        const savedMusicState = localStorage.getItem('edith-music-playing');
        if (savedMusicState === 'true') {
            toggleMusic(); // Will set the correct state
        }
    }

    function toggleMusic() {
        const musicBtn = document.getElementById('music-btn');

        if (musicPlaying) {
            backgroundMusic.pause();
            musicPlaying = false;
            musicBtn.innerHTML = '<i class="fas fa-music"></i> Music';
            localStorage.setItem('edith-music-playing', 'false');
            return "Music stopped.";
        } else {
            backgroundMusic.play().then(() => {
                backgroundMusic.volume = 0.3;
                musicPlaying = true;
                musicBtn.innerHTML = '<i class="fas fa-pause"></i> Music';
                localStorage.setItem('edith-music-playing', 'true');
            }).catch(error => {
                console.log('Music playback failed:', error);
                return "Music playback failed. Please check your browser settings.";
            });
            return "Music started. Enjoy your tunes, Vishal.";
        }
    }

    // ================ UTILITY FUNCTIONS ================
    function playStartupSound() {
        const voiceStartup = document.getElementById('voice-startup');
        voiceStartup.play().catch(error => {
            console.log('Startup sound failed:', error);
        });
    }

    function playCommandSound() {
        const voiceCommand = document.getElementById('voice-command');
        voiceCommand.play().catch(error => {
            console.log('Command sound failed:', error);
        });
    }

    function speakText(text) {
        const synth = window.speechSynthesis;

        if (synth.speaking) {
            synth.cancel();
        }

        const utterance = new SpeechSynthesisUtterance(text);

        // Try to find a good voice
        const voices = synth.getVoices();
        const preferredVoice = voices.find(voice =>
            voice.name.includes('Daniel') ||
            voice.name.includes('Google UK English Male') ||
            voice.name.includes('Microsoft David') ||
            voice.name.includes('Google US English Male')
        );

        if (preferredVoice) {
            utterance.voice = preferredVoice;
        }

        utterance.pitch = 0.9;
        utterance.rate = 1.1;
        utterance.volume = 0.8;

        utterance.onstart = () => {
            const speakBtn = document.getElementById('speak-btn');
            if (speakBtn) speakBtn.classList.add('speaking');
            createAudioPulse();
        };

        utterance.onend = () => {
            const speakBtn = document.getElementById('speak-btn');
            if (speakBtn) speakBtn.classList.remove('speaking');
        };

        synth.speak(utterance);
    }
    
    // ================ NEW FEATURES FOR V3 ================
    
    function createOrbParticles() {
        const particlesContainer = document.getElementById('orb-particles');
        particlesContainer.innerHTML = '';
        
        for (let i = 0; i < 30; i++) {
            const particle = document.createElement('div');
            particle.classList.add('orb-particle');
            
            // Random positions
            const tx = (Math.random() * 100 - 50) + 'px';
            const ty = (Math.random() * 100 - 50) + 'px';
            particle.style.setProperty('--tx', tx);
            particle.style.setProperty('--ty', ty);
            
            // Random animation duration
            const duration = 3 + Math.random() * 4;
            particle.style.animationDuration = `${duration}s`;
            
            // Random delay
            particle.style.animationDelay = `${Math.random() * 5}s`;
            
            particlesContainer.appendChild(particle);
        }
    }
    
    function createAudioPulse() {
        const orb = document.getElementById('edith-orb');
        const pulse = document.createElement('div');
        pulse.classList.add('audio-pulse');
        orb.appendChild(pulse);
        
        setTimeout(() => {
            pulse.remove();
        }, 2000);
    }
    
    function setupWaveform() {
        const waveform = document.getElementById('waveform');
        waveform.innerHTML = '';
        
        for (let i = 0; i < 20; i++) {
            const bar = document.createElement('div');
            bar.classList.add('wave-bar');
            bar.style.height = `${10 + Math.random() * 80}%`;
            bar.style.setProperty('--delay', i);
            waveform.appendChild(bar);
        }
    }
    
    function showSmartSuggestion() {
        const suggestion = document.getElementById('smart-suggestion');
        suggestion.classList.add('show');
        
        // Hide after 15 seconds
        setTimeout(() => {
            suggestion.classList.remove('show');
        }, 15000);
    }
    
    function showNotification(message) {
        const notification = document.getElementById('notification');
        notification.innerHTML = `<i class="fas fa-bell"></i> ${message}`;
        notification.classList.add('show');
        
        // Hide after 5 seconds
        setTimeout(() => {
            notification.classList.remove('show');
        }, 5000);
    }
</script>
<script>
    // ================ EMOTION DETECTION ================
    let emotionDetectionActive = true;
    let lastEmotion = null;
    let emotionHistory = [];

    async function initEmotionDetection() {
        try {
            // Load models from GitHub raw content
            await faceapi.nets.tinyFaceDetector.loadFromUri(
                'https://raw.githubusercontent.com/justadudewhohacks/face-api.js/master/weights'
            );
            await faceapi.loadFaceExpressionModel(
                'https://raw.githubusercontent.com/justadudewhohacks/face-api.js/master/weights'
            );

            // Start webcam
            const video = document.getElementById('emotion-video');
            const stream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: "user" }
            });
            video.srcObject = stream;

            // Start detection loop
            detectEmotion();
        } catch (error) {
            console.error('Emotion detection error:', error);
            showNotification("Emotion detection requires camera access");
        }
    }

    async function detectEmotion() {
        if (!emotionDetectionActive) return;

        const video = document.getElementById('emotion-video');
        const canvas = document.getElementById('emotion-canvas');
        const container = document.getElementById('emotion-container');

        if (video.readyState < 2) {
            setTimeout(detectEmotion, 100);
            return;
        }

        // Detect faces and expressions
        const detections = await faceapi.detectAllFaces(
            video,
            new faceapi.TinyFaceDetectorOptions()
        ).withFaceExpressions();

        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Get dominant emotion
        if (detections.length > 0) {
            container.classList.add('active');
            const expressions = detections[0].expressions;
            const dominant = Object.entries(expressions)
                .reduce((a, b) => a[1] > b[1] ? a : b)[0];

            // Update emotion history
            emotionHistory.push(dominant);
            if (emotionHistory.length > 10) emotionHistory.shift();

            // Only update if emotion changed
            if (dominant !== lastEmotion) {
                updateEmotionUI(dominant);
                lastEmotion = dominant;
            }
        } else {
            container.classList.remove('active');
        }

        // Continue detection loop
        setTimeout(detectEmotion, 1500);
    }

    function updateEmotionUI(emotion) {
        const moodIndicator = document.getElementById('mood-indicator');
        const orb = document.getElementById('edith-orb');

        // Map emotions to emojis
        const emotionMap = {
            'happy': '😊',
            'sad': '😔',
            'angry': '😠',
            'fearful': '😨',
            'disgusted': '🤢',
            'surprised': '😲',
            'neutral': '🤖'
        };

        // Update mood indicator
        moodIndicator.textContent = emotionMap[emotion] || '🤖';

        // Trigger orb pulse
        orb.classList.remove('emotion-pulse');
        setTimeout(() => orb.classList.add('emotion-pulse'), 10);

        // Show smart suggestion based on emotion
        showEmotionSuggestion(emotion);
    }

    function showEmotionSuggestion(emotion) {
        const suggestions = {
            'happy': "Nice to see you smiling, Vishal! Let's keep the energy high 🚀",
            'sad': "You seem down, Vishal. Would you like to hear an uplifting song?",
            'angry': "Rough day? I can help you relax. Want to hear calming music?",
            'fearful': "Everything's under control, Vishal. Would you like to review your project progress?",
            'disgusted': "Not your day? I've got a joke that might cheer you up!",
            'surprised': "I see that surprised look! Something exciting happening?",
            'neutral': "Deep in thought, Vishal? Need help with anything?"
        };

        const message = suggestions[emotion] || "How can I assist you today?";

        // Voice output
        speakText(`Vishal, I noticed you're feeling ${emotion}. ${message}`);

        // Update UI with suggestion
        const suggestion = document.getElementById('smart-suggestion');
        suggestion.querySelector('.suggestion-content').textContent = message;

        // Customize buttons based on emotion
        const yesBtn = document.getElementById('suggestion-yes');
        const noBtn = document.getElementById('suggestion-no');

        yesBtn.textContent = emotion === 'sad' ? "Play Music" :
            emotion === 'angry' ? "Calm Me" :
                "Yes";

        noBtn.textContent = "No Thanks";

        // Show the suggestion
        suggestion.classList.add('show');

        // Auto-hide after 10 seconds
        setTimeout(() => {
            suggestion.classList.remove('show');
        }, 10000);
    }

    // Initialize emotion detection when page loads
    document.addEventListener('DOMContentLoaded', initEmotionDetection);
</script>
<div id="emotion-container">
    <video id="emotion-video" autoplay muted playsinline></video>
    <canvas id="emotion-canvas"></canvas>
</div>
</body>
</html>
